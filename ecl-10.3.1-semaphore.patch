--- src/configure.orig	2010-03-05 07:00:37.000000000 -0700
+++ src/configure	2010-03-09 09:21:00.484055524 -0700
@@ -5824,18 +5824,13 @@
 cat >>conftest.$ac_ext <<_ACEOF
 /* end confdefs.h.  */
 
-#ifdef HAVE_SEMAPHORE_H
+#include <stdlib.h>
 #include <semaphore.h>
 int main() {
   sem_t aux;
   if (sem_init(&aux, 0, 0))
     exit(1);
   exit(0);
-#else
-int main() {
-  exit(1);
-}
-#endif
 }
 _ACEOF
 rm -f conftest$ac_exeext
